# Discord Registration Bot

Этот бот автоматизирует процесс регистрации новых участников на гильдийном Discord-сервере по игре Black Desert Online, предоставляя интерактивный опрос через приватные каналы и автоматически выдавая роли в зависимости от ответов.

## Основные функции

- **Автоматическая регистрация новых участников**
- **Гибкая система вопросов** (настраивается через JSON)
- **Приватные каналы** для каждого пользователя
- **Автоматическое назначение ролей** по результатам регистрации
- **Команды администрирования** для управления процессом
- **Конфигурация через Discord** без перезапуска бота

## Установка и запуск

1. **Требования**:
   - Go 1.23+
   - Discord аккаунт с правами администратора на сервере
   - Токен бота Discord ([получить здесь](https://discord.com/developers/applications))

2. **Клонирование репозитория**:
   ```bash
   git clone https://github.com/reinbowARA/DiscordRegistredBot
   cd DiscordRegistredBot
   ```

3. **Установка зависимостей**:
   ```bash
   go mod tidy
   ```

4. **Настройка конфигурации**:
- Создайте файл `.env` в корне проекта:
     ```
     DISCORD_BOT_TOKEN=your_discord_bot_token
     ```
- Можно заранее описать конфигурацию сервера для регистрации по [примеру файла конфигурации](#пример-файла-конфигурации-configjson)
  - Перед этим нужно в папке `config` создать файл `server_config.json`
1. **Запуск бота**:
   ```bash
   go run main.go
   ```

## Конфигурация сервера

Используйте команду `!init` для настройки сервера:

```
!init load - Загрузить конфигурацию из прикрепленного JSON-файла
!init save - Сохранить текущую конфигурацию
!init show - Показать текущую конфигурацию
!init template - Получить шаблон конфигурации
!init export - Экспортировать текущую конфигурацию
```

### Пример файла конфигурации (`config.json`):
```json
{
  "server_id": "123456789012345678",
  "registration_role_id": "987654321098765432",
  "category_id": "5678901234567890",
  "command_channel_id": "135791357913579",
  "guild_role_id" : "1238756172572365126",
  "friend_role_id" : "1232134214721947721"
}
```

## Настройка вопросов

Вопросы настраиваются через файл `questions.json`:

```json
[
  {
    "question": "Напишите вашу фамилию из игры и в скобках как к вам обращаться (пример: `Nikiwaru (Роман)`)",
    "result": "string"
  },
  {
    "question": "Вы уже являетесь членом нашей гильдии, или вы из другой гильдии для найма, или вы собираетесь к нам, но у вас есть вопросы?",
    "switch": {
      "1": "Я уже в гильдии",
      "2": "Я из другой гильдии",
      "3": "Ещё не определился/определилась, хочу задать вопрос"
    },
    "result": "int"
  }
]
```
> [!Warning]
> Изменить можно **только вопросы**, тонкой настройки ещё нет
## Команды администрирования

### Основные команды
- `!init` - Настройка сервера
- `!status` - Статус бота и сервера
- `!help` - Справка по командам

### Управление регистрацией
- `!startRegistred` - Запустить регистрацию для пользователей без роли
- `!stopRegistred` - Принудительно остановить все активные регистрации

### Управление ролями
- `!clsRoles` - Удалить все пользовательские роли (кроме сохраненных)

## Процесс регистрации

1. Новый участник присоединяется к серверу
2. Бот автоматически:
   - Выдает роль "Регистрация"
   - Создает приватный канал
   - Задает вопросы из `questions.json`
3. Пользователь отвечает на вопросы
4. По завершении:
   - Никнейм изменяется на игровой
   - Роль "Регистрация" удаляется
   - Выдается постоянная роль по выбору
   - Приватный канал удаляется через 30 секунд

## Лицензия

Этот проект распространяется под лицензией MIT. Подробнее см. в файле `LICENSE`.

## Поддержка

По вопросам и предложениям обращайтесь:
- Через Issues на GitHub
- В Discord: [reinbow_ara](https://discord.com/users/302859679929729024)
